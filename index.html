<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPM Analysis Form</title>
    <link href="styles.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="googleApiHandler.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <style>
/* --- 1. CSS Variables for Theming (Day/Night Mode) --- */
:root {
    --bg-gradient: linear-gradient(135deg, #0f172a, #1184f8);
    --text-color: #f8fafc;
    --text-muted: #cbd5e1;
    --accent-color: #00aaff;
    --accent-glow: rgba(0, 170, 255, 0.5);
    --border-color: rgba(0, 170, 255, 0.3); 
    --box-bg: rgba(20, 30, 48, 0.85);
    --input-bg: #111827; 
    --success-color: #22c55e;
    --danger-color: #ef4444;
    --font-main: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
    --h3-highlight-bg: rgba(88, 28, 135, 0.3); /* Dark Purple Glow */
    --h4-highlight-bg: rgba(17, 94, 89, 0.4);  /* Dark Teal Glow */
}

body.day-mode {
    --bg-gradient: linear-gradient(135deg, #82f9bf, #f8f9fa);
    --text-color: #0c0c0d;
    --text-muted: #495057;
    --accent-color: #0056b3;
    --accent-glow: rgba(0, 86, 179, 0.3);
    --border-color: rgba(0, 86, 179, 0.5); 
    --box-bg: rgb(255, 255, 255);
    --input-bg: #60caffc1;
    --success-color: #198754;
    --danger-color: #dc3545;
    --h3-highlight-bg: rgba(224, 242, 254, 0.8); /* Light Sky Blue */
    --h4-highlight-bg: rgba(220, 252, 231, 0.8); /* Light Mint Green */
}

/* --- 2. General Body and Layout Styles --- */
body {
    font-family: var(--font-main);
    background: var(--bg-gradient);
    color: var(--text-color);
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    transition: background 0.5s, color 0.5s;
}

.container {
    width: 100%;
    max-width: 1200px;
    background: transparent;
    padding: 25px;
    border-radius: 15px;
    position: relative;
}

/* --- 3. Header and Logo --- */
.logo {
    display: block;
    margin: 0 auto 15px auto;
    width: 300px;
    height: auto;
    filter: drop-shadow(0 0 10px var(--accent-glow));
}

h1 {
    color: var(--accent-color);
    text-align: center;
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 5px;
    letter-spacing: 2px;
    text-shadow: 0 0 15px var(--accent-glow);
}

h3, h4 {
    text-align: center;
    color: var(--text-muted);
    font-weight: 400; /* h4 ke liye neeche bold kiya gaya hai */
    margin: 10px auto 25px auto;
    padding: 8px 15px;
    border-radius: 8px;
    max-width: 80%;
    line-height: 1.5; /* Line-height behtar readability ke liye */
    border: 1px solid var(--border-color);
    transition: background-color 0.5s;
}

h3 {
    background-color: var(--h3-highlight-bg);
}

h4 {
    background-color: var(--h4-highlight-bg);
    font-weight: 700; /* Bold karne ke liye */
}

h2 {
    color: var(--text-color);
    border-bottom: 2px solid var(--accent-color);
    padding-bottom: 8px;
    font-size: 1.4rem;
    margin-bottom: 20px;
}

/* --- 4. Form Sections and Boxes --- */
.form-row {
    display: flex;
    gap: 25px;
    margin-bottom: 25px;
}

.form-section {
    flex: 1;
}

.box {
    background: var(--box-bg);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    padding: 20px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    transition: background 0.5s, border 0.5s;
}

.form-group {
    margin-bottom: 15px;
}

label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--text-muted);
    font-size: 0.9rem;
}

/* --- 5. Inputs, Selects, and Buttons --- */
input[type="text"],
input[type="datetime-local"],
input[type="file"],
select {
    width: 100%;
    padding: 12px;
    background-color: var(--input-bg);
    border: 1px solid var(--border-color);
    border-radius: 5px;
    color: var(--text-color);
    font-size: 1rem;
    box-sizing: border-box;
    transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
}

input:focus, select:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 3px var(--accent-glow);
}

input[readonly] {
    background-color: rgba(0,0,0,0.2);
    cursor: not-allowed;
}

button[type="submit"] {
    width: 100%;
    padding: 15px;
    font-size: 1.2rem;
    font-weight: bold;
    color: #fff;
    background: linear-gradient(45deg, var(--accent-color), var(--success-color));
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 20px;
    transition: transform 0.2s, box-shadow 0.2s;
}

button[type="submit"]:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

.manual-entry-btn {
    padding: 5px 10px;
    font-size: 0.8rem;
    cursor: pointer;
    background-color: var(--danger-color);
    color: white;
    border: none;
    border-radius: 4px;
    font-weight: bold;
    transition: background-color 0.3s;
}

.manual-entry-btn:hover {
    filter: brightness(1.2);
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

/* --- 6. Loading Spinner --- */
.loading-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    justify-content: center;
    align-items: center;
    z-index: 1000;
    backdrop-filter: blur(5px);
}

.loading-spinner {
    border: 8px solid #f3f3f3;
    border-top: 8px solid var(--accent-color);
    border-radius: 50%;
    width: 60px;
    height: 60px;
    animation: spin 1s linear infinite;
}
/* === High-Tech Train Loader CSS === */

.train-loader-container {
    position: relative;
    width: 250px;
    height: 250px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.track {
    position: absolute;
    width: 200px;
    height: 200px;
    border: 5px dashed rgba(255, 255, 255, 0.4);
    border-radius: 50%;
}

/* This arm rotates, carrying the train */
.train-arm {
    width: 200px;
    height: 200px;
    position: absolute;
    animation: moveOnTrack 4s linear infinite;
}

/* Keyframes for the arm's rotation */
@keyframes moveOnTrack {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.train {
    position: absolute;
    top: -15px; /* Adjust to place train on the track */
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: flex-end; /* Aligns coaches and engine at the bottom */
    /* Counter-rotation to keep the train upright */
    animation: stayUpright 4s linear infinite;
}

/* Keyframes to keep the train from spinning */
@keyframes stayUpright {
    from { transform: translateX(-50%) rotate(0deg); }
    to { transform: translateX(-50%) rotate(-360deg); }
}

/* Train Parts Styling */
.engine {
    position: relative;
    margin-right: 5px;
}

.engine-body {
    width: 60px;
    height: 30px;
    background: var(--danger-color, #ec0c0c);
    border-radius: 5px 5px 0 0;
    position: relative;
    z-index: 2;
}
/* Wheels for Engine */
.engine-body::before, .engine-body::after {
    content: '';
    position: absolute;
    bottom: -5px;
    width: 12px;
    height: 12px;
    background: #555;
    border: 2px solid #ccc;
    border-radius: 50%;
}
.engine-body::before { left: 8px; }
.engine-body::after { right: 8px; }


.engine-cabin {
    position: absolute;
    width: 30px;
    height: 25px;
    background: var(--accent-color, #00aaff);
    bottom: 30px;
    right: 0;
    border-radius: 5px 5px 0 0;
    border: 2px solid #fff;
    z-index: 1;
}

.coach {
    width: 50px;
    height: 28px;
    background: var(--accent-color, #00aaff);
    border: 2px solid #fff;
    border-radius: 3px;
    margin-left: -4px; /* Slight overlap */
    position: relative;
}
/* Wheels for Coaches */
.coach::before, .coach::after {
    content: '';
    position: absolute;
    bottom: -5px;
    width: 10px;
    height: 10px;
    background: #555;
    border: 2px solid #ccc;
    border-radius: 50%;
}
.coach::before { left: 5px; }
.coach::after { right: 5px; }

/* Smoke Animation */
.engine-smoke {
    position: absolute;
    top: -30px;
    left: 10px;
    display: flex;
}
.engine-smoke span {
    display: block;
    width: 8px;
    height: 8px;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 50%;
    margin: 0 2px;
    animation: smokePuff 1s infinite;
}
.engine-smoke span:nth-child(2) { animation-delay: 0.2s; }
.engine-smoke span:nth-child(3) { animation-delay: 0.4s; }

@keyframes smokePuff {
    0% { transform: translateY(0) scale(1); opacity: 1; }
    100% { transform: translateY(-20px) scale(2); opacity: 0; }
}
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* --- 7. Day/Night Toggle Switch --- */
.theme-switch-wrapper {
    position: absolute;
    top: 20px;
    right: 20px;
    display: flex;
    align-items: center;
}
.theme-switch {
    display: inline-block;
    height: 34px;
    position: relative;
    width: 60px;
}
.theme-switch input {
    display:none;
}
.slider {
    background-color: #3c4a5f;
    bottom: 0;
    cursor: pointer;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    transition: .4s;
    border-radius: 34px;
}
.slider:before {
    background-color: #fff;
    bottom: 4px;
    content: "☀️";
    height: 26px;
    left: 4px;
    position: absolute;
    transition: .4s;
    width: 26px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
}
input:checked + .slider {
    background-color: var(--accent-color);
}
input:checked + .slider:before {
    transform: translateX(26px);
    content: "🌙";
}
/* styles.css में यह जोड़ें */
.manual-link {
    display: block;
    text-align: center;
    margin-bottom: 15px;
    font-size: 1.1rem;
    color: var(--accent-color); /* यह आपके थीम के अनुसार रंग अपना लेगा */
    text-decoration: none;
    font-weight: bold;
}
.manual-link:hover {
    text-decoration: underline;
}
/* --- About Us Toggle (Updated for Scrolling Page) --- */
.about-us-toggle-container {
    /* This makes the icon part of the page flow */
    position: relative;
    display: flex;
    justify-content: flex-end; /* Pushes the icon to the right */
    margin-top: 30px; /* Space above the icon */
    padding-right: 10px;
}

/* New animation keyframes for the pulsing glow */
@keyframes pulse-glow {
    0% {
        box-shadow: 0 0 5px var(--accent-glow), 0 0 10px var(--accent-glow);
    }
    50% {
        box-shadow: 0 0 20px var(--accent-glow), 0 0 30px var(--accent-glow);
    }
    100% {
        box-shadow: 0 0 5px var(--accent-glow), 0 0 10px var(--accent-glow);
    }
}

.about-us-icon {
    background: var(--accent-color);
    color: #fff;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.5rem;
    font-weight: bold;
    font-family: 'Georgia', serif; /* More professional font for 'i' */
    cursor: pointer;
    border: 2px solid rgba(255, 255, 255, 0.7);
    transition: transform 0.3s ease;
    /* Apply the animation here */
    animation: pulse-glow 3s infinite;
}

.about-us-icon:hover {
    transform: scale(1.1);
    animation-play-state: paused; /* Pause the glow on hover */
}

.about-us-modal {
    /* Changed to absolute to position relative to its container */
    position: absolute;
    bottom: 120%; /* Position it directly above the icon */
    right: 0;
    background: var(--box-bg);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    z-index: 999;
    width: 400px;
    max-width: 90vw;
    max-height: 75vh;
    overflow-y: auto;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s;
}

.about-us-modal.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.about-us-modal h2 {
    color: var(--accent-color);
    border-bottom: 2px solid var(--accent-color);
    padding-bottom: 8px;
    font-size: 1.3rem;
    margin-top: 0;
    margin-bottom: 15px;
}

.about-us-modal h3 {
    color: var(--text-muted);
    font-size: 1rem;
    font-weight: bold;
    margin-top: 20px;
    margin-bottom: 10px;
    padding: 0;
    border: none;
    background: none;
    text-align: left;
}

.about-us-modal p, .about-us-modal li {
    font-size: 0.9rem;
    line-height: 1.6;
    color: var(--text-color);
}

.about-us-modal ul {
    list-style-type: disc;
    padding-left: 20px;
    margin: 0;
}

.contributor-card {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid var(--border-color);
}

.contributor-card h4 {
    margin: 0 0 5px 0;
    padding: 0;
    font-size: 1rem;
    color: var(--accent-color);
    background: none;
    border: none;
    text-align: left;
    max-width: 100%;
}

.contributor-card p {
    margin: 0;
}
/* --- 8. Toast Notification Styles --- */
#toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 2000; /* Sabse upar dikhega */
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.toast-message {
    background: var(--box-bg);
    color: var(--text-color);
    padding: 15px 20px;
    border-radius: 8px;
    border-left: 5px solid var(--accent-color);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    opacity: 0;
    transform: translateX(100%);
    transition: all 0.5s ease-in-out;
    font-size: 1rem;
    font-weight: 600;
}

/* Jab message dikhega */
.toast-message.show {
    opacity: 1;
    transform: translateX(0);
}
    </style>
</head>
<body>
    <div class="container">
        <img src="railway logo.png" alt="Railway Logo" class="logo">
        <div class="theme-switch-wrapper">
            <label class="theme-switch" for="checkbox">
                <input type="checkbox" id="checkbox" />
                <div class="slider round"></div>
            </label>
        </div>
        <h1>SANKET</h1>
        <a href="manual.html" target="_blank" class="manual-link">
           Need Help? View the User Manual
         </a>
        <h3>(SPM Analysis and Navigation KPA Extraction Tool)</h3>
        
        <h4>
            (Designed and Developed by Electrical(OP) Bilaspur S.E.C.Railway)
            <br>
            (इलेक्ट्रिकल (ओपी), बिलासपुर, द.पू.म. रेलवे द्वारा)
        </h4>
        
        <form id="spmForm">
            <div class="form-row">
                <div class="form-section">
                    <div class="section-header">
                        <h2>LP DETAILS</h2>
                        <button type="button" id="manualLpBtn" class="manual-entry-btn">MANNUAL ENTRY MODE</button>
                    </div>
                    <div class="box">
                        <div class="form-group">
                            <label for="lpId">LP ID</label>
                            <input type="text" id="lpId" name="lpId" required>
                        </div>
                        <div class="form-group">
                            <label for="lpName">LP Name</label>
                            <input type="text" id="lpName" name="lpName" readonly>
                        </div>
                        <div class="form-group">
                            <label for="lpDesg">LP Designation</label>
                            <input type="text" id="lpDesg" name="lpDesg" readonly>
                        </div>
                        <div class="form-group">
                            <label for="lpGroupCli">LP Group CLI</label>
                            <input type="text" id="lpGroupCli" name="lpGroupCli" readonly>
                        </div>
                        <div class="form-group">
                            <label for="lpCugNumber">LP CUG Number</label>
                            <input type="text" id="lpCugNumber" name="lpCugNumber" readonly>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="section-header">
                        <h2>ALP DETAILS</h2>
                        <button type="button" id="manualAlpBtn" class="manual-entry-btn">MANNUAL ENTRY MODE</button>
                    </div>
                    <div class="box">
                        <div class="form-group">
                            <label for="alpId">ALP ID</label>
                            <input type="text" id="alpId" name="alpId" required>
                        </div>
                        <div class="form-group">
                            <label for="alpName">ALP Name</label>
                            <input type="text" id="alpName" name="alpName" readonly>
                        </div>
                        <div class="form-group">
                            <label for="alpDesg">ALP Designation</label>
                            <input type="text" id="alpDesg" name="alpDesg" readonly>
                        </div>
                        <div class="form-group">
                            <label for="alpGroupCli">ALP Group CLI</label>
                            <input type="text" id="alpGroupCli" name="alpGroupCli" readonly>
                        </div>
                        <div class="form-group">
                            <label for="alpCugNumber">ALP CUG Number</label>
                            <input type="text" id="alpCugNumber" name="alpCugNumber" readonly>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-section">
                    <h2>TRAIN DETAILS</h2>
                    <div class="box">
                        <div class="form-group">
                            <label for="locoNumber">Loco Number</label>
                            <input type="text" id="locoNumber" name="locoNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="trainNumber">Train Number</label>
                            <input type="text" id="trainNumber" name="trainNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="rakeType">Type of Rake</label>
                            <select id="rakeType" name="rakeType" required>
                                <option value="" disabled selected>Select Rake Type</option>
                                <option value="GOODS">GOODS</option>
                                <option value="COACHING">COACHING</option>
                                <option value="MEMU">MEMU</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="maxPermissibleSpeed">Maximum Permissible Speed (kmph)</label>
                            <select id="maxPermissibleSpeed" name="maxPermissibleSpeed" required>
                                <option value="" disabled selected>Select Speed</option>
                                <option value="40">40 kmph</option>
                                <option value="45">45 kmph</option>
                                <option value="50">50 kmph</option>
                                <option value="55">55 kmph</option>
                                <option value="60">60 kmph</option>
                                <option value="65">65 kmph</option>
                                <option value="70">70 kmph</option>
                                <option value="75">75 kmph</option>
                                <option value="80">80 kmph</option>
                                <option value="85">85 kmph</option>
                                <option value="90">90 kmph</option>
                                <option value="95">95 kmph</option>
                                <option value="100">100 kmph</option>
                                <option value="105">105 kmph</option>
                                <option value="110">110 kmph</option>
                                <option value="115">115 kmph</option>
                                <option value="120">120 kmph</option>
                                <option value="125">125 kmph</option>
                                <option value="129">129 kmph</option>
                                <option value="130">130 kmph</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <h2>SECTION DETAILS</h2>
                    <div class="box">
                        <div class="form-group">
                            <label for="section">Section</label>
                            <select id="section" name="section" required>
                                <option value="" disabled selected>Select Section</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="fromSection">From Section</label>
                            <select id="fromSection" name="fromSection" required>
                                <option value="" disabled selected>Select From Station</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="toSection">To Section</label>
                            <select id="toSection" name="toSection" required>
                                <option value="" disabled selected>Select To Station</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-section">
                <h2>ANALYSIS DETAILS</h2>
                <div class="box">
                    <div class="form-group">
                        <label for="spmType">Type of SPM</label>
                        <select id="spmType" name="spmType" required>
                            <option value="" disabled selected>Select SPM Type</option>
                            <option value="Laxven">Laxven</option>
                            <option value="Medha">Medha</option>
                            <option value="Telpro">Telpro</option>
                            <option value="MR">MR</option>
                            <option value="VEL">VEL</option>
                            <option value="RTIS">RTIS</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="cliName">CLI NAME (Analysis and Ambush done by)</label>
                        <select id="cliName" name="cliName" required>
                            <option value="" selected disabled>-- Select a Name --</option>
            <option value="A.N.PANDEY">A.N.PANDEY</option>
            <option value="A.K.VERMA">A.K.VERMA</option>
            <option value="ABDUL SAMAD GHAURI">ABDUL SAMAD GHAURI</option>
            <option value="ADESH SHUKLA">ADESH SHUKLA</option>
            <option value="AJAY KUMAR">AJAY KUMAR</option>
            <option value="ANIL KUMAR">ANIL KUMAR</option>
            <option value="ANKLESHWAR KUMAR">ANKLESHWAR KUMAR</option>
            <option value="ASHOK KUMAR">ASHOK KUMAR</option>
            <option value="ASHOK KUMAR MISHRA">ASHOK KUMAR MISHRA</option>
            <option value="B BHARADWAJ">B BHARADWAJ</option>
            <option value="B G RAHULAN">B G RAHULAN</option>
            <option value="BHASKAR SAHOO">BHASKAR SAHOO</option>
            <option value="BHAWANAND GOPE">BHAWANAND GOPE</option>
            <option value="BHILU RAM TUDU">BHILU RAM TUDU</option>
            <option value="BIDHAN CHANDRA ROY">BIDHAN CHANDRA ROY</option>
            <option value="BRIJ BHUSHAN SINGH">BRIJ BHUSHAN SINGH</option>
            <option value="BRIJESH SHARMA">BRIJESH SHARMA</option>
            <option value="CHAKRESH KUMAR">CHAKRESH KUMAR</option>
            <option value="CHAMAN LAL">CHAMAN LAL</option>
            <option value="CHANDRA PRAKASH RATHORE">CHANDRA PRAKASH RATHORE</option>
            <option value="CHANDRA SHEKHAR SONI">CHANDRA SHEKHAR SONI</option>
            <option value="CHANDRASHEKHAR">CHANDRASHEKHAR</option>
            <option value="D.K.RAY">D.K.RAY</option>
            <option value="D.S.PAIKRA">D.S.PAIKRA</option>
            <option value="D.SANGA">D.SANGA</option>
            <option value="DAYARAM PASWAN">DAYARAM PASWAN</option>
            <option value="DHARAM PAL">DHARAM PAL</option>
            <option value="DILHARAN LAL ADITYA">DILHARAN LAL ADITYA</option>
            <option value="DINESH KUMAR RAIDAS">DINESH KUMAR RAIDAS</option>
            <option value="DUSHYANT KUMAR YADAV">DUSHYANT KUMAR YADAV</option>
            <option value="G L TANDON">G L TANDON</option>
            <option value="G.GOVIND RAO">G.GOVIND RAO</option>
            <option value="G.N.ORAM">G.N.ORAM</option>
            <option value="G.P.KASHYAP DSL">G.P.KASHYAP DSL</option>
            <option value="GAUKARAN KUMBHAKAR">GAUKARAN KUMBHAKAR</option>
            <option value="GOPAL DAS DSL">GOPAL DAS DSL</option>
            <option value="GOPI KUMAR KANWAR">GOPI KUMAR KANWAR</option>
            <option value="H.N.NAYAK">H.N.NAYAK</option>
            <option value="HARI SHANKAR SINGH">HARI SHANKAR SINGH</option>
            <option value="HARISH KUMAR SHARMA">HARISH KUMAR SHARMA</option>
            <option value="HEMANT KUMAR DEULKAR">HEMANT KUMAR DEULKAR</option>
            <option value="HEMANT KUMAR MAHOR">HEMANT KUMAR MAHOR</option>
            <option value="HIMMAT SINGH BHADAURIA">HIMMAT SINGH BHADAURIA</option>
            <option value="I.A. ANSARI">I.A. ANSARI</option>
            <option value="J.P.VERMA">J.P.VERMA</option>
            <option value="JAGAT PAL BOUDDH">JAGAT PAL BOUDDH</option>
            <option value="JASWANT SINGH">JASWANT SINGH</option>
            <option value="KAMESHWAR SINGH RAJPUT">KAMESHWAR SINGH RAJPUT</option>
            <option value="KARTA LAKRA">KARTA LAKRA</option>
            <option value="KHELA MARDI">KHELA MARDI</option>
            <option value="LAXMAN PRASAD">LAXMAN PRASAD</option>
            <option value="LAXMIKANT SHARAFF">LAXMIKANT SHARAFF</option>
            <option value="LAXMIKANT SAHU">LAXMIKANT SAHU</option>
            <option value="LEELAMBAR SAHU">LEELAMBAR SAHU</option>
            <option value="LOKNATH PRADHAN">LOKNATH PRADHAN</option>
            <option value="M ANAND RAO">M ANAND RAO</option>
            <option value="M SANYASI">M SANYASI</option>
            <option value="M.K.PANDAB">M.K.PANDAB</option>
            <option value="M.K.TIWARI">M.K.TIWARI</option>
            <option value="M.NAYAK">M.NAYAK</option>
            <option value="M.S.MARABI">M.S.MARABI</option>
            <option value="MAHENDRA KUMAR">MAHENDRA KUMAR</option>
            <option value="MAHESH KUMAR YADAV DSL">MAHESH KUMAR YADAV DSL</option>
            <option value="MANOJ KUMAR CHANDRAKER">MANOJ KUMAR CHANDRAKER</option>
            <option value="MD.TANVIR ALAM">MD.TANVIR ALAM</option>
            <option value="N.K.BANJARE">N.K.BANJARE</option>
            <option value="N.K.PRASAD">N.K.PRASAD</option>
            <option value="N.R.MISHRA">N.R.MISHRA</option>
            <option value="N.RAVICHANDRAN">N.RAVICHANDRAN</option>
            <option value="N.SAHU">N.SAHU</option>
            <option value="NARAYAN PANDA">NARAYAN PANDA</option>
            <option value="OMPRAKASH">OMPRAKASH</option>
            <option value="OM PRAKASH PANDEY">OM PRAKASH PANDEY</option>
            <option value="P.K.SHRIVASATAVA">P.K.SHRIVASATAVA</option>
            <option value="P.K.RAJWADE">P.K.RAJWADE</option>
            <option value="P.LIGARI">P.LIGARI</option>
            <option value="P.MITRA BRJN DSL">P.MITRA BRJN DSL</option>
            <option value="PARMANAND">PARMANAND</option>
            <option value="PRABHAT KUMAR DAS">PRABHAT KUMAR DAS</option>
            <option value="PRADEEP KUMAR GUPTA">PRADEEP KUMAR GUPTA</option>
            <option value="PREM PRAKASH TIWARI DSL">PREM PRAKASH TIWARI DSL</option>
            <option value="R.C.SAHU">R.C.SAHU</option>
            <option value="R.K.SINGH DSL">R.K.SINGH DSL</option>
            <option value="R.S.THAKUR">R.S.THAKUR</option>
            <option value="RAM AWADH">RAM AWADH</option>
            <option value="RAMAKANTA DASH">RAMAKANTA DASH</option>
            <option value="RAKESH KUMAR GAUTAM">RAKESH KUMAR GAUTAM</option>
            <option value="RAMESH YADAV DSL">RAMESH YADAV DSL</option>
            <option value="RAMSAJEEWAN PATEL">RAMSAJEEWAN PATEL</option>
            <option value="ROHIT KUMAR TIWARI">ROHIT KUMAR TIWARI</option>
            <option value="S.C.MAURYA">S.C.MAURYA</option>
            <option value="S.K.ACHARYA">S.K.ACHARYA</option>
            <option value="S.K.DAS">S.K.DAS</option>
            <option value="S.K.GOUDA">S.K.GOUDA</option>
            <option value="S.K.HOTA">S.K.HOTA</option>
            <option value="S.K.KUSHWAHA">S.K.KUSHWAHA</option>
            <option value="S.K.SAHU DSL">S.K.SAHU DSL</option>
            <option value="S.K.SUMAN">S.K.SUMAN</option>
            <option value="S.K.TRIPATHY">S.K.TRIPATHY</option>
            <option value="S.P.DEY">S.P.DEY</option>
            <option value="S.P.RAMASHANKAR">S.P.RAMASHANKAR</option>
            <option value="S.PARIDA">S.PARIDA</option>
            <option value="S.S.KOLWADKAR DSL">S.S.KOLWADKAR DSL</option>
            <option value="SANDEEP CHOUBEY">SANDEEP CHOUBEY</option>
            <option value="SANDEEP KUMAR">SANDEEP KUMAR</option>
            <option value="SANJAY GIRI">SANJAY GIRI</option>
            <option value="SANJAY PASWAN">SANJAY PASWAN</option>
            <option value="SARVESH KUMAR DUBEY">SARVESH KUMAR DUBEY</option>
            <option value="SANT BHUSHAN PATLEY">SANT BHUSHAN PATLEY</option>
            <option value="SANTOSH KUMAR">SANTOSH KUMAR</option>
            <option value="SATYA DEV">SATYA DEV</option>
            <option value="SHAKIL AHMED DSL">SHAKIL AHMED DSL</option>
            <option value="SHASHI BHUSAN">SHASHI BHUSAN</option>
            <option value="SHYAM BIHARI SINGH">SHYAM BIHARI SINGH</option>
            <option value="SHYAMAL DAS (DSL)">SHYAMAL DAS (DSL)</option>
            <option value="SUBHASH CHANDRA">SUBHASH CHANDRA</option>
            <option value="SUBODH KUMAR DSL">SUBODH KUMAR DSL</option>
            <option value="SUDHIR KUMAR SINHA">SUDHIR KUMAR SINHA</option>
            <option value="SUMANT KUMAR BAGHMAR">SUMANT KUMAR BAGHMAR</option>
            <option value="SUNIL KUMAR GUPTA">SUNIL KUMAR GUPTA</option>
            <option value="SURENDRA KUMAR PRETA DSL">SURENDRA KUMAR PRETA DSL</option>
            <option value="SURESH CHANDRA">SURESH CHANDRA</option>
            <option value="SURESH CHANDRA SDL">SURESH CHANDRA SDL</option>
            <option value="SURESH SINGH CHAUHAN">SURESH SINGH CHAUHAN</option>
            <option value="T.K.VERMA">T.K.VERMA</option>
            <option value="U.K.MADHU">U.K.MADHU</option>
            <option value="U.P.SINHA">U.P.SINHA</option>
            <option value="UTTAM KUMAR SAHU">UTTAM KUMAR SAHU</option>
            <option value="VIDYAKAR RAI DSL">VIDYAKAR RAI DSL</option>
            <option value="VIJAY KUMAR">VIJAY KUMAR</option>
            <option value="VIKASH KUMAR DSL">VIKASH KUMAR DSL</option>
            <option value="VINAY KUMAR SAHU">VINAY KUMAR SAHU</option>
            <option value="VINOD KUMAR">VINOD KUMAR</option>
            <option value="VINOD KUMAR RAI">VINOD KUMAR RAI</option>
            <option value="VISHNU MOHAN SINGH RAJPUT">VISHNU MOHAN SINGH RAJPUT</option>
            <option value="VIVEK KUMAR">VIVEK KUMAR</option>
            <option value="YASHWANT KUMAR VERMA">YASHWANT KUMAR VERMA</option>
            <option value="YOGENDRA KUMAR">YOGENDRA KUMAR</option>  
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fromDateTime">From Date and Time</label>
                        <input type="datetime-local" id="fromDateTime" name="fromDateTime" required>
                    </div>
                    <div class="form-group">
                        <label for="toDateTime">To Date and Time</label>
                        <input type="datetime-local" id="toDateTime" name="toDateTime" required>
                    </div>
                    <div class="form-group">
                        <label for="cugFile">Upload CUG.csv File</label>
                        <input type="file" id="cugFile" name="cugFile" accept=".csv">
                    </div>
                    <div class="form-group">
                        <label for="spmFile">Upload SPM File</label>
                        <input type="file" id="spmFile" name="spmFile" accept=".xlsx,.xls,.txt,.pdf" required>
                    </div>
                </div>
            </div>
            <button type="submit">ANALYZE THE SPM DATA</button>
        </form>
         <div class="about-us-toggle-container">
        <div class="about-us-icon" id="aboutUsToggle">i</div>
       <div class="about-us-modal" id="aboutUsModal">
    <h2>About SANKET</h2>
    <p>
        <b>SANKET</b> (SPM Analysis and Navigation KPA Extraction Tool) is a sophisticated web application engineered to revolutionize the analysis of locomotive data recorder (SPM) files. Spearheaded by the Electrical (OP) department of SECR, Bilaspur, this tool automates the meticulous process of monitoring train operations, evaluating crew performance, and ensuring safety compliance.
    </p>

    <h3>Key Features</h3>
    <ul>
        <li><b>Universal SPM Compatibility:</b> Seamlessly processes data from a wide array of SPM systems, including Laxven, Medha, Telpro, MR, VEL, and RTIS.</li>
        <li><b>Intelligent Anomaly Detection:</b> Automatically identifies and reports critical operational anomalies like overspeeding, wheel slip, and improper brake application.</li>
        <li><b>Advanced Data Visualization:</b> Renders complex data into intuitive, interactive charts for clear interpretation of locomotive performance.</li>
        <li><b>Automated Reporting & Logging:</b> Instantly generates comprehensive PDF reports and logs all findings to a centralized Google Sheet for robust record-keeping and trend analysis.</li>
    </ul>

    <div class="contributor-card">
        <h3>The Development Team</h3>
        
        <h4>Visionary & Motivational Support</h4>
        <p><b>Shri Masud Alam, Sr. DEE/OP/BSP</b><br>Provided the essential leadership and encouragement that propelled this project from concept to reality.</p>
        
        <h4 style="margin-top:15px;">Technical & Domain Expertise</h4>
        <p><b>Shri N Ravichandran, CLI/BSP</b><br>Offered invaluable expert guidance on locomotive operations and data interpretation, ensuring the tool's accuracy and relevance.</p>

        <h4 style="margin-top:15px;">Lead Developer & Architect</h4>
        <p><b>Shri Mohammad Rustam Khan, Sr. ALP/BSP</b><br>Masterminded the core architecture, coding, and web design, transforming complex requirements into a functional and user-friendly application.</p>

        <h4 style="margin-top:15px;">Data Management & Curation</h4>
        <p><b>Shri Chandan Shah, Sr. ALP/BSP</b><br><b>Shri Rupesh Kumar Verma, TECH-1/BSP</b><br>Instrumental in arranging, structuring, and validating the vast datasets required for the tool's backend logic.</p>
    </div>
</div>
    </div>
    <canvas id="speedChart" style="display: none;"></canvas>
    <canvas id="stopChart" style="display: none;"></canvas>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="train-loader-container">
            <div class="track"></div>
            <div class="train-arm">
                <div class="train">
                    <div class="engine">
                        <div class="engine-body"></div>
                        <div class="engine-cabin"></div>
                        <div class="engine-smoke">
                            <span></span><span></span><span></span>
                        </div>
                    </div>
                    <div class="coach"></div>
                    <div class="coach"></div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Global function to toggle loading overlay
        window.toggleLoadingOverlay = function(show) {
            document.getElementById('loadingOverlay').style.display = show ? 'flex' : 'none';
        };

        function loadScript(src, callback) {
            const existingScript = document.querySelector('script[data-spm-script]');
            if (existingScript) existingScript.remove();
            const script = document.createElement('script');
            script.src = src;
            script.async = true;
            script.dataset.spmScript = true;
            script.onload = callback;
            script.onerror = () => {
                alert(`Failed to load script: ${src}. Please ensure the script exists and try again.`);
                window.toggleLoadingOverlay(false);
            };
            document.body.appendChild(script);
        }

        let crewData = [];
        let stationSignalData = [];
        // cugData will be populated from the uploaded file

        const fetchCSV = async (filePath) => {
            try {
                const response = await fetch(filePath);
                if (!response.ok) throw new Error(`Failed to fetch ${filePath}: ${response.statusText}`);
                const text = await response.text();
                return new Promise((resolve) => {
                    Papa.parse(text, {
                        header: true,
                        skipEmptyLines: true,
                        transform: (value, field) => value.trim(),
                        complete: (result) => resolve(result.data),
                    });
                });
            } catch (error) {
                console.error(`Error loading ${filePath}:`, error);
                throw error;
            }
        };

        document.addEventListener('DOMContentLoaded', async () => {
            // --- Theme Switcher Logic ---
            const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
            const currentTheme = localStorage.getItem('theme');

            if (currentTheme) {
                document.body.classList.add(currentTheme);
                if (currentTheme === 'day-mode') {
                    toggleSwitch.checked = false;
                } else {
                    toggleSwitch.checked = true;
                }
            } else {
                // Default to night mode if no theme is saved
                document.body.classList.add('day-mode');
                 toggleSwitch.checked = false;
            }

            function switchTheme(e) {
                if (e.target.checked) {
                    document.body.classList.remove('day-mode');
                    localStorage.setItem('theme', 'night-mode');
                } else {
                    document.body.classList.add('day-mode');
                    localStorage.setItem('theme', 'day-mode');
                }
            }

            toggleSwitch.addEventListener('change', switchTheme, false);
            // --- End Theme Switcher Logic ---
            try {
                crewData = await fetchCSV('CREW.csv');
                console.log('Loaded CREW Data:', crewData);
                stationSignalData = await fetchCSV('Station_Signal_Interdistant.csv');
                console.log('Loaded Station Signal Data:', stationSignalData);

                window.crewData = crewData;
                window.stationSignalData = stationSignalData;

                const sectionSelect = document.getElementById('section');
                const uniqueSections = [...new Set(stationSignalData.map(row => row['SECTION']))];
                uniqueSections.forEach(section => {
                    const option = document.createElement('option');
                    option.value = section;
                    option.textContent = section;
                    sectionSelect.appendChild(option);
                });

                const fromSectionSelect = document.getElementById('fromSection');
                const toSectionSelect = document.getElementById('toSection');

                sectionSelect.addEventListener('change', (e) => {
                    const selectedSection = e.target.value;
                    fromSectionSelect.innerHTML = '<option value="" disabled selected>Select From Station</option>';
                    toSectionSelect.innerHTML = '<option value="" disabled selected>Select To Station</option>';
                    if (selectedSection) {
                        const stations = [...new Set(stationSignalData
                            .filter(row => row['SECTION'] === selectedSection)
                            .map(row => row['STATION']))];
                        stations.forEach(station => {
                            const option = document.createElement('option');
                            option.value = station;
                            option.textContent = station;
                            fromSectionSelect.appendChild(option);
                            toSectionSelect.appendChild(option.cloneNode(true));
                        });
                    }
                });

                document.getElementById('lpId').addEventListener('input', (e) => {
                    const input = e.target;
                    let value = input.value.toUpperCase();
                    input.value = value.replace(/[^A-Z0-9]/g, '');
                    const lpId = e.target.value.trim();
                    const lpRecord = crewData.find(record => record['CREWID'] === lpId);
                    if (lpRecord) {
                        console.log(`LP ID ${lpId} matched with details:`, lpRecord);
                        document.getElementById('lpName').value = lpRecord['CREW NAME'] || '';
                        document.getElementById('lpDesg').value = lpRecord['DESG'] || '';
                        document.getElementById('lpGroupCli').value = lpRecord['CLI NAME'] || '';
                        document.getElementById('lpCugNumber').value = lpRecord['CUG NUMBER'] || '';
                    } else {
                        document.getElementById('lpName').value = '';
                        document.getElementById('lpDesg').value = '';
                        document.getElementById('lpGroupCli').value = '';
                        document.getElementById('lpCugNumber').value = '';
                        console.log(`No record found for LP ID: ${lpId}`);
                    }
                });

                document.getElementById('alpId').addEventListener('input', (e) => {
                    const input = e.target;
                    let value = input.value.toUpperCase();
                    input.value = value.replace(/[^A-Z0-9]/g, '');
                    const alpId = e.target.value.trim();
                    const alpRecord = crewData.find(record => record['CREWID'] === alpId);
                    if (alpRecord) {
                        console.log(`ALP ID ${alpId} matched with details:`, alpRecord);
                        document.getElementById('alpName').value = alpRecord['CREW NAME'] || '';
                        document.getElementById('alpDesg').value = alpRecord['DESG'] || '';
                        document.getElementById('alpGroupCli').value = alpRecord['CLI NAME'] || '';
                        document.getElementById('alpCugNumber').value = alpRecord['CUG NUMBER'] || '';
                    } else {
                        document.getElementById('alpName').value = '';
                        document.getElementById('alpDesg').value = '';
                        document.getElementById('alpGroupCli').value = '';
                        document.getElementById('alpCugNumber').value = '';
                        console.log(`No record found for ALP ID: ${alpId}`);
                    }
                });
                
                // --- MANUAL ENTRY BUTTON LOGIC ---
                const manualLpBtn = document.getElementById('manualLpBtn');
                const manualAlpBtn = document.getElementById('manualAlpBtn');

                const lpFields = [
                    document.getElementById('lpName'),
                    document.getElementById('lpDesg'),
                    document.getElementById('lpGroupCli'),
                    document.getElementById('lpCugNumber')
                ];

                const alpFields = [
                    document.getElementById('alpName'),
                    document.getElementById('alpDesg'),
                    document.getElementById('alpGroupCli'),
                    document.getElementById('alpCugNumber')
                ];
                
                manualLpBtn.addEventListener('click', () => {
                    lpFields.forEach(field => {
                        field.readOnly = false;
                    });
                    document.getElementById('lpName').focus();
                });
                
                manualAlpBtn.addEventListener('click', () => {
                    alpFields.forEach(field => {
                        field.readOnly = false;
                    });
                    document.getElementById('alpName').focus();
                });
                // --- END MANUAL ENTRY LOGIC ---
                // --- START: Force Uppercase for Manual Entry ---
                const allManualFields = [...lpFields, ...alpFields];

                allManualFields.forEach(field => {
                    field.addEventListener('input', () => {
                        // Store cursor position
                        const start = field.selectionStart;
                        const end = field.selectionEnd;
                        // Convert to uppercase
                        field.value = field.value.toUpperCase();
                        // Restore cursor position
                        field.setSelectionRange(start, end);
                    });
                });
                // --- END: Force Uppercase for Manual Entry ---


                const spmTypeSelect = document.getElementById('spmType');
                let currentScript = null;

                spmTypeSelect.addEventListener('change', (e) => {
                    const spmType = e.target.value;
                    const fileInput = document.getElementById('spmFile');
                    if (spmType === 'Medha') {
                        fileInput.accept = '.txt';
                    } else if (spmType === 'MR' || spmType === 'VEL') {
                        fileInput.accept = '.pdf';
                    } else {
                        fileInput.accept = '.xlsx, .xls';
                    }
                    if (spmType) {
                        const scriptFile = `${spmType}.js`;
                        loadScript(scriptFile, () => {
                            console.log(`${scriptFile} loaded successfully`);
                            currentScript = scriptFile;
                        });
                    }
                });

                const parseCugFile = (file) => {
                    return new Promise((resolve, reject) => {
                        Papa.parse(file, {
                            header: true,
                            skipEmptyLines: true,
                            transform: (value) => value.trim(),
                            complete: (result) => {
                                console.log('Raw CUG Data from upload:', result.data);
                                const processedData = result.data.map(call => {
                                    const startDateTimeStr = call['Start Date & Time']?.trim();
                                    const endDateTimeStr = call['End Date & Time']?.trim();
                                    const dateTimeRegex = /^(?:(\d{2})[-\/](\d{2})[-\/](\d{4})|(\d{4})[-\/](\d{2})[-\/](\d{2}))\s(\d{2}):(\d{2})(?::(\d{2}))?$/;
                                    const startMatch = startDateTimeStr?.match(dateTimeRegex);
                                    const endMatch = endDateTimeStr?.match(dateTimeRegex);
                                    if (startMatch && endMatch) {
                                        let startDateTime, endDateTime;
                                        const startSeconds = startMatch[9] || '00';
                                        const endSeconds = endMatch[9] || '00';
                                        if (startMatch[1]) { // DD-MM-YYYY
                                            startDateTime = new Date(`${startMatch[3]}-${startMatch[2]}-${startMatch[1]}T${startMatch[7]}:${startMatch[8]}:${startSeconds}`);
                                            endDateTime = new Date(`${endMatch[3]}-${endMatch[2]}-${endMatch[1]}T${endMatch[7]}:${endMatch[8]}:${endSeconds}`);
                                        } else { // YYYY-MM-DD
                                            startDateTime = new Date(`${startMatch[4]}-${startMatch[5]}-${startMatch[6]}T${startMatch[7]}:${startMatch[8]}:${startSeconds}`);
                                            endDateTime = new Date(`${endMatch[4]}-${endMatch[5]}-${endMatch[6]}T${endMatch[7]}:${endMatch[8]}:${endSeconds}`);
                                        }
                                        return {
                                            ...call,
                                            startDateTime,
                                            endDateTime,
                                            duration: parseInt(call['Duration in Sec']) || 0,
                                            'CUG MOBILE NO': call['CUG MOBILE NO']?.trim()
                                        };
                                    } else {
                                        console.warn('Invalid date format in CUG.csv:', { startDateTimeStr, endDateTimeStr });
                                        return null;
                                    }
                                }).filter(call => call && !isNaN(call.startDateTime.getTime()) && !isNaN(call.endDateTime.getTime()) && !isNaN(call.duration));
                                
                                console.log('Processed CUG Data from upload:', processedData);
                                resolve(processedData);
                            },
                            error: (error) => {
                                console.error('Error parsing CUG.csv:', error);
                                reject(error);
                            }
                        });
                    });
                };

                document.getElementById('spmForm').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    document.getElementById('loadingOverlay').style.display = 'flex';

                    const spmType = document.getElementById('spmType').value;
                    const spmFile = document.getElementById('spmFile').files[0];
                    const cugFile = document.getElementById('cugFile').files[0];
                    if (!spmType) {
                        alert('Please select an SPM Type.');
                        document.getElementById('loadingOverlay').style.display = 'none';
                        return;
                    }
                    if (!spmFile) {
                        alert('Please upload an SPM file.');
                        document.getElementById('loadingOverlay').style.display = 'none';
                        return;
                    }
                    const fileExt = spmFile.name.split('.').pop().toLowerCase();

// Naya aur saaf validation logic
if (['Laxven', 'Telpro', 'RTIS'].includes(spmType) && !['xlsx', 'xls'].includes(fileExt)) {
    alert(`Please upload an Excel file (.xlsx or .xls) for ${spmType} SPM.`);
    document.getElementById('loadingOverlay').style.display = 'none';
    return;
} else if (spmType === 'Medha' && fileExt !== 'txt') {
    alert('Please upload a .txt file for Medha SPM.');
    document.getElementById('loadingOverlay').style.display = 'none';
    return;
} else if ((spmType === 'MR' || spmType === 'VEL') && fileExt !== 'pdf') {
    alert('Please upload a .pdf file for MR or VEL SPM.');
    document.getElementById('loadingOverlay').style.display = 'none';
    return;
}
                    if (!currentScript) {
                        alert(`No script loaded for SPM Type: ${spmType}. Please select SPM Type first.`);
                        document.getElementById('loadingOverlay').style.display = 'none';
                        return;
                    }
                });

            } catch (error) {
                console.error('Error loading initial CSV files:', error);
                alert('Failed to load CREW.csv or Station_Signal_Interdistant.csv. Ensure the files are available and correctly formatted.');
                document.getElementById('loadingOverlay').style.display = 'none';
            }
        });
        // This script should be at the end of the body
        document.addEventListener('DOMContentLoaded', function() {
            const aboutUsToggle = document.getElementById('aboutUsToggle');
            const aboutUsModal = document.getElementById('aboutUsModal');

            if (aboutUsToggle) {
                aboutUsToggle.addEventListener('click', function() {
                    aboutUsModal.classList.toggle('show');
                });
            }

            // Close the modal if the user clicks anywhere outside of the modal content and the icon
            window.addEventListener('click', function(event) {
                if (!aboutUsModal.contains(event.target) && !aboutUsToggle.contains(event.target)) {
                    aboutUsModal.classList.remove('show');
                }
            });
        });
        // YEH NAYA FUNCTION ADD KAREIN
        function showToast(message) {
            const container = document.getElementById('toast-container');
            if (!container) return; // Agar container nahi hai to kuch na kare

            const toast = document.createElement('div');
            toast.className = 'toast-message';
            toast.textContent = message;

            container.appendChild(toast);

            // Animation ke saath dikhane ke liye
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);

            // Message ko 4 second ke baad gayab karne ke liye
            setTimeout(() => {
                toast.classList.remove('show');
                // Animation poora hone ke baad element ko delete kar dega
                toast.addEventListener('transitionend', () => toast.remove());
            }, 4000);
        }

        // Aapka baaki ka Javascript code yahan se shuru hoga...
        window.toggleLoadingOverlay = function(show) {
            // ...
        };
    </script>
    <div id="toast-container"></div>
</body>

</html>

